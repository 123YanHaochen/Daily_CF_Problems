**提示 1：** 考虑每只老鼠可能出现的位置。哪些位置放置没有意义？

**提示 2：** 放置捕鼠夹的位置如何分组？每组中怎么选？

简单的一个基环树的图论问题。

我们注意到，在这种每个点都仅有一个出度的图中，图的形态是：

- 一些环。

- 一些指向这些环的树。

也就是每个点出发，最后都会进入一个环，且最后不断在环中进行循环。

注意到，每个环上我们必须放至少一个捕鼠夹，因为如果其中一个环没有，那么如果老鼠在环上则无法捕捉。而要成本最小，也就只需要取最小的环上成本。

因此，环外的点没有放捕鼠夹的必要，因为环外的点总会入环，被环上的捕鼠夹抓到。

于是，综上所述，我们找到所有的环，在每个环中寻找成本最小的点，进行成本加总即可。

找环可以通过 DFS 等多种方式实现，时间复杂度为 $\mathcal{O}(n)$ .

#### 具体代码如下（只包含中间处理部分）——

```Python []
def main():
    n = II()
    nums = LII()
    next_pos = LGMI()

    ans = 0
    vis = [-1] * n
    for i in range(n):
        # 走到没遇到的点就走一遍
        if vis[i] == -1:
            u = i
            while vis[u] == -1:
                vis[u] = i
                u = next_pos[u]
            # 截止点是当前循环的
            if vis[next_pos[u]] == i:
                res = nums[u]
                v = u
                # 遍历一遍环
                while next_pos[v] != u:
                    v = next_pos[v]
                    res = min(res, nums[v])
                ans += res
    print(ans)
```